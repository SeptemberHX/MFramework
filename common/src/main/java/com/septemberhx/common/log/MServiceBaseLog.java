package com.septemberhx.common.log;

import lombok.Getter;
import lombok.Setter;
import org.json.JSONObject;

import java.util.Map;

/**
 * @author SeptemberHX
 * @date 2019/8/26
 * @version 0.1
 *
 * Basic log type of services.
 * All the logs will be generated by the MClient module
 */
@Getter
@Setter
public abstract class MServiceBaseLog extends MBaseLog {
    protected String logObjectId;  // the id of the MObject which writes the log
    protected String logMethodName;  // the name of the function
    protected String logUserId;  // the unique id for each user

    @Override
    protected String[] fillInfo(String[] strArr) {
        String[] leftStrArr = super.fillInfo(strArr);
        if (leftStrArr != null) {
            this.logUserId = leftStrArr[0];
            this.logObjectId = leftStrArr[1];
            this.logMethodName = leftStrArr[2];
            return getUnusedStrArr(leftStrArr, 3);
        }
        return null;
    }

    @Override
    protected void fillInfo(Map<String, Object> logMap) {
        super.fillInfo(logMap);
        this.logUserId = (String)logMap.get("logUserId");
        this.logObjectId = (String)logMap.get("logObjectId");
        this.logMethodName = (String)logMap.get("logMethodName");
    }

    @Override
    protected String uniqueLogInfo() {
        return this.concatInfo(super.uniqueLogInfo(), logUserId, logObjectId, logMethodName);
    }

    @Override
    public JSONObject toJson() {
        JSONObject jsonObject = super.toJson();
        jsonObject.put("logUserId", this.logUserId);
        jsonObject.put("logMethodName", this.logMethodName);
        jsonObject.put("logObjectId", this.logObjectId);
        return jsonObject;
    }
}
